"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=t(require("node-fetch")),n=t(require("unist-util-visit")),r=t(require("url-join")),o=require("os");function s(t,e){return e?function(t){let e;return t.forEach(t=>{const n=t.match(/^\s+/);t&&(n&&n[0]?(void 0===e&&(e=n[0].length),n[0].length>0&&n[0].length<e&&(e=n[0].length)):e=0)}),t.map(t=>t.slice(e))}(function(t,e){let n=0,r=t.length;return t.forEach((t,o)=>{t.includes("START "+e)&&(n=o+1),t.includes("END "+e)&&(r=o)}),t.slice(n,r)}(t.split(o.EOL),e)).join(o.EOL):t}function u(t=""){const e=t.split(" ");let n,r;for(const t of e)t.startsWith("url=")&&(n=t.replace("url=","")),t.startsWith("tag=")&&(r=t.replace("tag=",""));return{url:n,tag:r}}exports.default=function(t){return async function(i){const l=[],c=[];n(i,"code",t=>l.push(t));for(const n of l){if(!n.meta){c.push(new Promise(t=>t(n)));continue}const{url:i,tag:l}=u(n.meta);if(!i){c.push(new Promise(t=>t(n)));continue}const a=t&&t.pathPrefix?r(t.pathPrefix,i):i;c.push(new Promise((r,u)=>{e(a).then(t=>(200!==t.status&&console.log(`Error fetching ${a} - status ${t.status}`),t.text())).then(e=>{n.value=s(e,l),null!=t&&t.replaceTabsToSpaces&&(n.value=n.value.split(o.EOL).map(t=>t.replace(/\t/g,"  ")).join(o.EOL)),r(n)}).catch(t=>{console.log("Error fetching "+a),u(t)})}))}c.length&&await Promise.all(c)}};
//# sourceMappingURL=remark-fetch-code.cjs.production.min.js.map
